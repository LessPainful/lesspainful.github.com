<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>blog.LessPainful.com</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link href="http://www.lesspainful.com/stylesheets/styles.css?1328445224" media="screen" rel="stylesheet" type="text/css" />
  <script src="http://www.lesspainful.com/javascripts/jquery-1.5.1.min.js?1328445224" type="text/javascript"></script>
  <script type="text/javascript">
    /*
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-22081783-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    */

    $(document).ready(function(){
      //$("#logoring, #footer").css('opacity',0.7);
      $("#logolink").hover(
        function(){
          $("#logoring").stop(true,false).animate({
            'opacity' : 1
          },'fast');
        },
        function(){
          $("#logoring").stop(true,false).animate({
            'opacity' : 0.7
          },'fast');
        }
      );
      $("#footer").hover(
        function(){
          $("#footer").stop(true,false).animate({
            'opacity' : 1
          },'fast');
        },
        function(){
          $("#footer").stop(true,false).animate({
            'opacity' : 0.7
          },'fast');
        }
      );
    });

  </script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-29395630-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>

  <style type="text/css" media="screen">
    
    /* BLOG STYLES */
    pre {
      background-color: white;
      color: black;
      padding: 0px;
    }
    body {
      background-color:#19171b; 
      color:#c7c3ca;
    }
    a {
      color:#a7e252;
    }
    a:hover {
      color:#bef969;
    }
    .blogposts {
      width:710px;
    }
    .post {
      margin-top:40px;
      width:100%;
    }
    .post div {
      
    }
    .post .p_head {
      height:100px;
    }
      .post .p_thumb {
        width:80px;
        height:80px;
        margin-right:20px;
        background-color:rgba(255,255,255,0.5);
        background-repeat:no-repeat;
        background-position:center center;
        overflow:hidden;
      }
      .post .p_title {
        width:600px;
        height:58px;
        padding:0;
      }
        .post .p_title h1, .post .p_title a {
          color:#efefef;
        }
        .post .p_title a:hover {
          color:#fff;
        }
        .post .p_title h1 {
          position:absolute;
          width:100%;
          height:auto;
          left:0;
          bottom:0;
          margin:0;
          padding:0;
          letter-spacing:0;
          color:#efefef;
        }
      .post .p_info {
        width:600px;
        height:19px;
        line-height:14px;
        padding-top:5px;
      }
      .post .p_info {
        
      }
    .post .p_content {
      width:670px;
      background:#efefef;
      color:#333;
      padding:20px;
    }
      .post .p_content .p_media {
        width:100%;
        height:290px;
        background-color:rgba(0,0,0,0.15);
        vertical-align:middle;
        text-align:center;
        background-position:center center;
        background-repeat:no-repeat;
        overflow:hidden;
        margin-bottom:25px;
      }
      .post .p_content .p_body {
        width:660px;
      }
        .post .p_content a {
          color:#5b910c !important;
        }
        .post .p_content a:hover {
          color:#72ae1b !important;
        }
      .post .p_content .p_link {
        font-size:16px;
        line-height:20px;
        margin-top:10px;
      }
    
    .posts_nav {
      width:100%;
      height:80px;
      clear:both;
      text-transform:uppercase;
      font-size:16px;
      line-height:16px;
      font-family: "Arial Rounded MT Bold", Arial, Helvetica, sans-serif;
      font-weight:bold;
      margin-top:30px;
    }
      .posts_nav a {
        position:absolute;
        width:auto;
        height:auto;
        top:0;
        border:0px solid blue;
        padding:15px;
      }
      .posts_nav .older_posts_link {
        left:-15px;
      }
      .posts_nav .newer_posts_link {
        right:-15px;
      }
    
      
    .p_thumb, .p_content, .p_media, .blognavs .b_nav {
      border-radius: 6px; -moz-border-radius: 6px; -webkit-border-radius: 6px;
    }
    
    pre, code {
      padding:5px;
    }
    
    .blognavs {
      width:170px;
      margin-left:20px;
      margin-top:110px;
      border:0px solid blue;
      right:-10px;
    }
    .blognavs .b_nav {
      width:144px;
      padding:20px 13px 22px 13px;
      margin-top:30px;
    }
      .blognavs .b_nav h3, .blognavs .b_nav h3 a {
        color:#fff !important;
        margin:0 0 12px 0 !important;
        padding:0 !important;
        line-height:16px !important;
      }
      .blognavs .b_nav a {
        position:relative;
        float:left;
        clear:both;
        width:100%;
        line-height:14px;
        padding:5px 0;
        border:1px solid rgba(255,255,255,0.25);
        border-width:0px 0px 1px 0px;
        color:#efefef;
      }
      .blognavs .b_nav h3 a {
        margin:0;
        padding:0;
        border:0;
      }
      .blognavs .b_nav a:hover {
        color:#fff;
      }
      .blognavs .b_nav a.first {
        border-width:1px 0px 1px 0px;
      }
      .blognavs .b_nav a.last {
        border-width:0px 0px 1px 0px;
      }
    
    .p_content, .b_nav, .p_thumb {
      box-shadow: 0px 3px 20px rgba(0,0,0,0.7);
      -moz-box-shadow : 0px 3px 20px rgba(0,0,0,0.7);
      -webkit-box-shadow : 0px 3px 20px rgba(0,0,0,0.7);
    }
    
    .arrow_up_light {
      position:absolute;
      width:27px;
      height:13px;
      left:28px;
      top:-13px;
      background:transparent url('img/arrowbox_light.png') no-repeat left top;
    }
    
    .arrow_left {
      position:absolute;
      width:27px;
      height:27px;
      left:-13px;
      top:15px;
    }
    .arrow_left.blue {
      background:transparent url('img/arrowbox_blue.png') no-repeat left top;
    }
    
    .arrow_left.green {
      background:transparent url('img/arrowbox_green.png') no-repeat left top;
    }
    
    .arrow_left.dark {
      background:transparent url('img/arrowbox_dark.png') no-repeat left top;
    }
    
  </style>
</head>
<body class="">



<div id="headerwrap">
  <div id="header">
    <div id="logoring"></div>

    <div id="logo"></div>
    <div id="logolink"><a href="/"><img src="/img/blank.gif" alt="LessPainful" width="100%" height="100%" /></a></div>

    <div id="topnav">
      <a href="https://www.lesspainful.com/">Home</a>
      <a href="https://www.lesspainful.com/pricing">Pricing</a>
      <a href="https://www.lesspainful.com/documentation">Documentation</a>
      <a href="https://blog.lesspainful.com" class="active">Blog</a>
      <a href="/users/sign_up">Sign up</a>
      <a href="/users/sign_in">Log in</a>
    </div>
  </div>
</div>



<div class="wrap nopadding nomargin" style="min-height:400px">

  <div class="center">
    
    <div class="blogposts">
      
      <section> 
        <div class="content">
  <div class="post">
      <div class="p_head">
        <div class="p_thumb" style="background-image:url('/img/karl.jpg')"></div>
        <div class="p_title">
          <h1><a href="/2012/02/21/Calabash-iOS">An Overview of Calabash iOS</a></h1>
        </div>
        <div class="p_info">
          Posted by Karl Krukow - February 21, 2012
        </div>
      </div>
      <div class="p_content lightbg">
        <div class="arrow_up_light"></div>
        <div class="p_body">
        <h2>An Overview of Calabash iOS</h2>

<p>Calabsh iOS is a new open source project for functional testing of iPhone and iPad apps based on <a href="http://cukes.info">Cucumber</a>.</p>

<p>This post describes <a href="http://github.com/calabash/calabash-ios">Calabash iOS</a> in some technical detail. It will give you an architectural overview and compare Calabash iOS with some other functional testing alternatives (hence, it is fairly advanced and assumes that you are familiar with <a href="http://cukes.info">Cucumber</a> and iOS development).</p>

<ul>
<li>For an introduction to Calabash and LessPainful (and some info on Cucumber), please read <a href="...">Calabash: Functional Testing for Mobile Apps</a>.</li>
<li>Instructions for how to use Calabash in your iOS project can be found in the <a href="http://github.com/calabash/calabash-ios">Github Readme</a>.</li>
<li>For a tutorial on how to use Calabash iOS once setup, please see <a href="https://github.com/calabash/calabash-ios/wiki">Getting started guide</a>.</li>
</ul>


<h2>Calabash Architecture</h2>

<p>Calabash tests are executed with the <a href="http://cukes.info">Cucumber tool</a> and consist of three parts:</p>

<ul>
<li><p><em>Your app</em>, linked with the <code>calabash.framework</code> which embeds an HTTP server in your app (of course, this is only in <em>test builds</em> of your app). The Calabash client library (see next bullet) makes HTTP requests to the server when it wants to do something with the current view.</p></li>
<li><p><em>The Calabash client library</em> and <em>step definitions</em>. Calabash supports two types of step definitions: <a href="https://github.com/calabash/calabash-ios/wiki/02-Predefined-steps">built-in</a> and custom. The built-ins define general and domain-neutral steps that are intended to give you a quick and easy start. They contain steps like: <code>I should see a "..." button</code> and <code>I swipe right</code>. The custom steps are written by you, and they&rsquo;re specific to your domain or application. Examples could be: <code>I should be on the Login screen</code>, <code>I login as Pete</code> or <code>I add a track to my playlist</code>. To implement a custom step you can use methods defined in the Calabash <em>client library</em>, calabash-cucumber,  which is part of <a href="http://github.com/calabash/calabash-ios">Calabash iOS</a>.</p></li>
<li><p><em>Your feature files</em>. The feature files describe the app use-cases you want to test. They are simultaneously a specification of the behaviour of your app and an executable test suite.</p></li>
</ul>


<p>You can visualize this as:</p>

<p><img src="/img/calabash-ios.png" alt="Calabash-iOS architecture" /></p>

<p>Calabash iOS supports running on the iOS simulator as well as iPhones, iPads and iPod touches (whether jailbroken or not). The calabash server framework is distributed as a  universal framework for your convenience.</p>

<p>The client library, calabash-cucumber, is installed using <a href="http://rubygems.org/">RubyGems</a> (see detailed instructions under <a href="https://github.com/calabash/calabash-ios">Installing the client</a>).</p>

<h3>Comparison with other functional testing systems</h3>

<p>There are several options out there for functional testing on iOS. Apple provides its <a href="https://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/_index.html">UIAutomation</a>, there is <a href="http://www.zucchiniframework.org/">Zucchini</a>, <a href="https://github.com/moredip/Frank">Frank</a> by Pete Hodgson, <a href="https://github.com/square/KIF">KIF</a> by square, <a href="http://www.gorillalogic.com/fonemonkey">FoneMonkey</a> by Gorilla Logic, <a href="https://github.com/unboxed/icuke">iCuke</a> by Rob Holland, and probably a few I&rsquo;ve looked at and forgotten again!</p>

<p>All the projects have their advantages and disadvantages, Calabash included. But we think that Calabash hits a sweet spot that none other the other options cover.</p>

<h3>Frank</h3>

<p><a href="https://github.com/moredip/Frank">Frank</a> is the library closest to Calabash; in fact, when we started experimenting with iOS support at LessPainful we started with Frank. Frank is a very cool project by a great person (that&rsquo;s you Pete), and Calabash is highly inspired by it. But there were a couple of important reasons why we could not use Frank.</p>

<p>First, Frank is licensed using GNU GPLv3 and we wanted to use the less restrictive EPL. Pete actually didn&rsquo;t want to license Frank as GPL, but since Frank is based on UISpec which is GPL'ed, he had to. We did not want the <a href="http://code.google.com/p/uispec/">UISpec</a> project as a dependency.</p>

<p>Second, when we started to look at Frank, it was a bit of a pain to set up (in the mean time, its actually gotten much better). It required modification of you app source, inclusion of static resources and source files. We wanted calabash to be easy to set up, so we made Calabash a universal framework.</p>

<p>Third, Frank is focused on running in the iOS simulator. We wanted something that ran equally well on simulator, iPhone and iPad. There is no fundamental reason that the Frank architecture shouldn&rsquo;t work on physical devices (indeed Calabash has the same architecture), but many of Frank&rsquo;s step definitions are simulator only.</p>

<p>Finally, we needed support for some advanced features that Frank just didn&rsquo;t have. Frank&rsquo;s touch emulation is derived from <a href="http://code.google.com/p/uispec/">UISpec</a>, which has some disadvantages: it only supports tapping, and actually doesn&rsquo;t seem to work in all cases (<a href="https://groups.google.com/group/frank-discuss/tree/browse_frm/month/2011-09/cc1fb65c717180c5">for example on a UISwitch</a>). We wanted support for gestures like swipe, pinch-to-zoom, backgrounding and rotation. We wanted support for querying and acting on UIWebViews.</p>

<p>Frank also has the cool Symbiote tool which let&rsquo;s you explore your app from a browser. We don&rsquo;t have Symbiote in Calabash, but instead we have a powerful console based tool for interacting and exploring your application (more on this in a later blog post).</p>

<h3>KIF, iCuke, FoneMonkey</h3>

<p>KIF is another cool project. KIF has an Apache 2.0 license which is ok, but two primary things kept us from going down this route. First, KIF is based on the same touch emulation code as UISpec, and has the same limitations (which actually goes back to a seminal CocoaWithLove post from 2008, <a href="http://cocoawithlove.com/2008/10/synthesizing-touch-event-on-iphone.html">Synthesizing touch events on iPhone</a>). Secondly, KIF tests are written in Objective-C, and we specifically wanted <a href="http://cukes.info">Cucumber</a> for the reasons outlined in the <a href="...">Introductory post</a>.</p>

<p><a href="https://github.com/unboxed/icuke">iCuke</a> actually looked very promising two years ago. Unfortunately its author, Rob Holland, has abandoned it, and we had a difficult time proceeding with it.</p>

<p>FoneMonkey, is GPL licensed and doesn&rsquo;t support Cucumber (also, I have a personal issue with recording-based approaches to test code generation).</p>

<h3>UIAutomation and Zucchini</h3>

<p>Apple&rsquo;s UIAutomation framework is actually quite advanced in supporting various gestures. It&rsquo;s also simple to set up since it works without modification to the app (runs via instruments). There are a couple of reasons why we decided not to use UIAutomation.</p>

<p>First, UIAutomation is not open source &ndash; this means we have to wait for Apple to make bug fixes, and we can&rsquo;t extend it. It is also very poorly documented by Apple, and not that much information available on the net.</p>

<p>Second, tests are written in JavaScript using a horrible API, resulting in tests that are too easy to break when making minor changes to the UI (IMHO). The tool for developing and running tests (UIAutomation Instrument) gives an inefficient workflow, for example, by locking the editing file, missing the ability to interactively explore your app and running only parts of a test. Also, screenshotting only works on device.</p>

<p>Third, UIAutomation is hard to get working in a continuous integration setup (in fact, when we first looked at it, CI was completely impossible). Extracting tests results and screenshots in a CI friendly way is hard.</p>

<p><a href="http://www.zucchiniframework.org/">Zucchini</a>, is a new project that&rsquo;s very cool. It has some great addons for working with app screenshots (we might &lsquo;borrow&rsquo; those for Calabash :), and it makes the developer experience much better by using CoffeeScript instead of JavaScript and by coming with some convenience tools. However, by compiling to UIAutomation compatible JavaScript and running via UIAutomation, it has some of the same problems as UIAutomation itself (lack of documentation, Apple control, the fragility of tests, etc.). Also, we didn&rsquo;t want Calabash users to be required to learn CoffeeScript.</p>

<h3>What&rsquo;s next?</h3>

<p>So there you have it! A short overview of the Calabash iOS
architecture and an overview of similar frameworks.</p>

<p>In upcoming posts we&rsquo;ll describe more implementation details of Calabash iOS. For example, we&rsquo;ll show how to make advanced custom steps using the client library API, we&rsquo;ll look at support for rotation and gestures like swiping, and even how you can record your own advanced gestures. We&rsquo;ll also look at an efficient workflow for writing tests in an interactive and exploratory manner.</p>

<p>In the meantime please try out <a href="https://github.com/calabash/calabash-ios">Calabash iOS</a>, read the <a href="https://github.com/calabash/calabash-ios/wiki/00-Calabash-iOS-documentation">Project wiki documentation</a>, and tell us what you think: <a href="https://github.com/calabash/calabash-ios/issues">Issues</a> and <a href="https://groups.google.com/forum/?fromgroups#!forum/calabash-ios">Discussion</a>.</p>

        </div>
      
    
	    <div id="disqus_thread"></div>
			<script type="text/javascript">
			    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			    var disqus_shortname = 'lesspainfulblog'; // required: replace example with your forum shortname
			    /* * * DON'T EDIT BELOW THIS LINE * * */
			    (function() {
			        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			    })();
			</script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
			</div>
		</div>
</div>

      </section>
    </div>
    
    
    
    
    
    <div class="blognavs">
      
      <div class="b_nav bluebg">
        <div class="arrow_left blue"></div>
        <h3><a href="#more_stuff">Navigation<br/>and Stuff</a></h3>
        <a href="https://www.lesspainful.com" class="first">LessPainful.com ›</a>
        <a href="https://github.com/calabash">Calabash on GitHub ›</a>
      </div>

      <div class="b_nav greenbg">
        <div class="arrow_left green"></div>
        <h3><a href="#categories_page">History</a></h3>
        
          <a class="first" href="/2012/02/25/Calabash-Android"> An Overview of Calabash Android ›</a>
        
          <a class="" href="/2012/02/21/Calabash-iOS"> An Overview of Calabash iOS ›</a>
        
          <a class="last" href="/2012/02/20/Calabash"> Calabash ›</a>
        
      </div>
  </div>

</div>




<div id="footerwrap">
  <div id="footer">
    <div id="copyrightinfo">
      Copyright © LessPainful 2011&nbsp;&nbsp;·&nbsp;&nbsp;LessPainful ApS CVR: 33 64 49 49&nbsp;&nbsp;·&nbsp;&nbsp;Phone: +45 77 34 27 40&nbsp;&nbsp;·&nbsp;&nbsp;<a href="mailto:contact@lesspainful.com">contact@lesspainful.com</a>
    </div>
    <div id="footerlogo"></div>
  </div>
</div>


</body>
</html>
